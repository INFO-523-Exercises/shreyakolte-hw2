<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="shreyakolte">

<title>hw2-02</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw-02-02_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw-02-02_files/libs/quarto-html/quarto.js"></script>
<script src="hw-02-02_files/libs/quarto-html/popper.min.js"></script>
<script src="hw-02-02_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw-02-02_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw-02-02_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw-02-02_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw-02-02_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw-02-02_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw-02-02_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">hw2-02</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>shreyakolte </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="imputing-like-a-data-scientist" class="level1">
<h1>IMPUTING LIKE A DATA SCIENTIST:</h1>
<section id="required-setup" class="level3">
<h3 class="anchored" data-anchor-id="required-setup">Required Setup:</h3>
<p>First we will install all the packages required for our operations on our dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sets the number of significant figures to two - e.g., 0.01</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Required package for quick package downloading and loading </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(cluster, <span class="co"># K cluster analyses</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               dlookr, <span class="co"># Exploratory data analysis</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               formattable, <span class="co"># HTML tables from R outputs</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               ggfortify, <span class="co"># Plotting tools for stats</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               ggpubr, <span class="co"># Publishable ggplots</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               here, <span class="co"># Standardizes paths to data</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               kableExtra, <span class="co"># Alternative to formattable</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               knitr, <span class="co"># Needed to write HTML reports</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               missRanger, <span class="co"># To generate NAs</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>               plotly, <span class="co"># Visualization package</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               rattle, <span class="co"># Decision tree visualization</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>               rpart, <span class="co"># rpart algorithm</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>               tidyverse, <span class="co"># Powerful data wrangling package suite</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>               visdat) <span class="co"># Another EDA visualization package</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global ggplot() theme</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Theme pub_clean() from the ggpubr package with base text size = 16</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_pubclean</span>(<span class="at">base_size =</span> <span class="dv">16</span>)) </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># All axes titles to their respective far right sides</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove axes ticks</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove legend key</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-and-downloading-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-downloading-the-dataset">LOADING AND DOWNLOADING THE DATASET:</h3>
<p>Here we will load the dataset which we are going to use for doing all our operations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's load a data set from the diabetes data set</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-09-05/demographics.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1327 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): facet
dbl (7): year, sample_size, employment, members, covered, p_members, p_covered

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>demographics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,327 × 8
    year sample_size employment members covered p_members p_covered facet       
   &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       
 1  1973       49095     75519.  18089.     NA      0.240    NA     all wage an…
 2  1974       48245     77101.  18176.     NA      0.236    NA     all wage an…
 3  1975       46488     75704.  16778.     NA      0.222    NA     all wage an…
 4  1976       47648     78777.  17403.     NA      0.221    NA     all wage an…
 5  1977       57191     81334.  19335.  21535.     0.238     0.265 all wage an…
 6  1978       57321     84966.  19548.  21898.     0.230     0.258 all wage an…
 7  1979       58080     87117.  20986.  23540.     0.241     0.270 all wage an…
 8  1980       68594     87480.  20095.  22493.     0.230     0.257 all wage an…
 9  1981       15433     89538.  19137.  21453.     0.214     0.240 all wage an…
10  1983      173932     88290.  17717.  20532.     0.201     0.233 all wage an…
# ℹ 1,317 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What does the data look like?</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
sample_size
</th>
<th style="text-align:right;">
employment
</th>
<th style="text-align:right;">
members
</th>
<th style="text-align:right;">
covered
</th>
<th style="text-align:right;">
p_members
</th>
<th style="text-align:right;">
p_covered
</th>
<th style="text-align:right;">
facet
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1973
</td>
<td style="text-align:right;">
49095
</td>
<td style="text-align:right;">
75519
</td>
<td style="text-align:right;">
18089
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1974
</td>
<td style="text-align:right;">
48245
</td>
<td style="text-align:right;">
77101
</td>
<td style="text-align:right;">
18176
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1975
</td>
<td style="text-align:right;">
46488
</td>
<td style="text-align:right;">
75704
</td>
<td style="text-align:right;">
16778
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1976
</td>
<td style="text-align:right;">
47648
</td>
<td style="text-align:right;">
78777
</td>
<td style="text-align:right;">
17403
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1977
</td>
<td style="text-align:right;">
57191
</td>
<td style="text-align:right;">
81334
</td>
<td style="text-align:right;">
19335
</td>
<td style="text-align:right;">
21535
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1978
</td>
<td style="text-align:right;">
57321
</td>
<td style="text-align:right;">
84966
</td>
<td style="text-align:right;">
19548
</td>
<td style="text-align:right;">
21898
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="diagnose-your-data" class="level3">
<h3 class="anchored" data-anchor-id="diagnose-your-data">DIAGNOSE YOUR DATA:</h3>
<p>The data set which we are using is being diagnosed here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the properties of the data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diagnose</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
variables
</th>
<th style="text-align:right;">
types
</th>
<th style="text-align:right;">
missing_count
</th>
<th style="text-align:right;">
missing_percent
</th>
<th style="text-align:right;">
unique_count
</th>
<th style="text-align:right;">
unique_rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
year
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
0.037
</td>
</tr>
<tr>
<td style="text-align:right;">
sample_size
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1295
</td>
<td style="text-align:right;">
0.976
</td>
</tr>
<tr>
<td style="text-align:right;">
employment
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1327
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:right;">
members
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1327
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:right;">
covered
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
6.9
</td>
<td style="text-align:right;">
1236
</td>
<td style="text-align:right;">
0.931
</td>
</tr>
<tr>
<td style="text-align:right;">
p_members
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1327
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:right;">
p_covered
</td>
<td style="text-align:right;">
numeric
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
6.9
</td>
<td style="text-align:right;">
1236
</td>
<td style="text-align:right;">
0.931
</td>
</tr>
<tr>
<td style="text-align:right;">
facet
</td>
<td style="text-align:right;">
character
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
0.021
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="diagnose-outliers" class="level3">
<h3 class="anchored" data-anchor-id="diagnose-outliers">DIAGNOSE OUTLIERS:</h3>
<p>Here we will diagnose the outliers by plotting a box plot and histogram.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table showing outliers</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diagnose_outlier</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(outliers_ratio <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> outliers_mean <span class="sc">/</span> with_mean) <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(rate)) <span class="sc">|&gt;</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>outliers_cnt) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
variables
</th>
<th style="text-align:right;">
outliers_ratio
</th>
<th style="text-align:right;">
outliers_mean
</th>
<th style="text-align:right;">
with_mean
</th>
<th style="text-align:right;">
without_mean
</th>
<th style="text-align:right;">
rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
sample_size
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
1.6e+05
</td>
<td style="text-align:right;">
3.9e+04
</td>
<td style="text-align:right;">
3.4e+04
</td>
<td style="text-align:right;">
4.2
</td>
</tr>
<tr>
<td style="text-align:right;">
employment
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:right;">
1.2e+05
</td>
<td style="text-align:right;">
3.0e+04
</td>
<td style="text-align:right;">
2.7e+04
</td>
<td style="text-align:right;">
4.2
</td>
</tr>
<tr>
<td style="text-align:right;">
covered
</td>
<td style="text-align:right;">
2.4
</td>
<td style="text-align:right;">
1.9e+04
</td>
<td style="text-align:right;">
4.8e+03
</td>
<td style="text-align:right;">
4.4e+03
</td>
<td style="text-align:right;">
4.0
</td>
</tr>
<tr>
<td style="text-align:right;">
members
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.7e+04
</td>
<td style="text-align:right;">
4.4e+03
</td>
<td style="text-align:right;">
4.0e+03
</td>
<td style="text-align:right;">
3.9
</td>
</tr>
<tr>
<td style="text-align:right;">
p_covered
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
7.0e-01
</td>
<td style="text-align:right;">
2.3e-01
</td>
<td style="text-align:right;">
2.1e-01
</td>
<td style="text-align:right;">
3.0
</td>
</tr>
<tr>
<td style="text-align:right;">
p_members
</td>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
6.3e-01
</td>
<td style="text-align:right;">
2.1e-01
</td>
<td style="text-align:right;">
1.8e-01
</td>
<td style="text-align:right;">
3.0
</td>
</tr>
</tbody>

</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots and histograms of data with and without outliers</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">find_outliers</span>(demographics)) <span class="sc">|&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">plot_outlier</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="basic-exploration-of-missing-values-nas" class="level2">
<h2 class="anchored" data-anchor-id="basic-exploration-of-missing-values-nas"><strong>Basic Exploration of Missing Values (NAs):</strong></h2>
<p>Table showing the extent of NAs in columns containing them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly generate NAs for 30</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>na.demographics <span class="ot">&lt;-</span> demographics <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generateNA</span>(<span class="at">p =</span> <span class="fl">0.3</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># First six rows</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>na.demographics <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
sample_size
</th>
<th style="text-align:right;">
employment
</th>
<th style="text-align:right;">
members
</th>
<th style="text-align:right;">
covered
</th>
<th style="text-align:right;">
p_members
</th>
<th style="text-align:right;">
p_covered
</th>
<th style="text-align:right;">
facet
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1973
</td>
<td style="text-align:right;">
49095
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
48245
</td>
<td style="text-align:right;">
77101
</td>
<td style="text-align:right;">
18176
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1975
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
75704
</td>
<td style="text-align:right;">
16778
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1976
</td>
<td style="text-align:right;">
47648
</td>
<td style="text-align:right;">
78777
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1977
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
81334
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21535
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
all wage and salary workers
</td>
</tr>
<tr>
<td style="text-align:right;">
1978
</td>
<td style="text-align:right;">
57321
</td>
<td style="text-align:right;">
84966
</td>
<td style="text-align:right;">
19548
</td>
<td style="text-align:right;">
21898
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>

</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the NA table</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>na.demographics <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_na_pareto</span>(<span class="at">only_na =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>() <span class="co"># Publishable table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:right;">
variable
</th>
<th style="text-align:right;">
frequencies
</th>
<th style="text-align:right;">
ratio
</th>
<th style="text-align:right;">
grade
</th>
<th style="text-align:right;">
cumulative
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
covered
</td>
<td style="text-align:right;">
465
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
p_covered
</td>
<td style="text-align:right;">
462
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
28
</td>
</tr>
<tr>
<td style="text-align:right;">
employment
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:right;">
facet
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
52
</td>
</tr>
<tr>
<td style="text-align:right;">
members
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
64
</td>
</tr>
<tr>
<td style="text-align:right;">
p_members
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
76
</td>
</tr>
<tr>
<td style="text-align:right;">
sample_size
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
88
</td>
</tr>
<tr>
<td style="text-align:right;">
year
</td>
<td style="text-align:right;">
398
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
Bad
</td>
<td style="text-align:right;">
100
</td>
</tr>
</tbody>

</table>
</div>
</div>
<ul>
<li><p>Plots showing the frequency of missing values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the insersect of the columns with missing values</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This plot visualizes the table above</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>na.demographics <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_na_pareto</span>(<span class="at">only_na =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ul>
</section>
<section id="advanced-exploration-of-missing-values-nas" class="level2">
<h2 class="anchored" data-anchor-id="advanced-exploration-of-missing-values-nas"><strong>Advanced Exploration of Missing Values (NAs):</strong></h2>
<p>Intersect plot that shows, for every combination of columns relevant, how many missing values are common</p>
<p>Orange boxes are the columns in question</p>
<p>x axis (top green bar plots) show the number of missing values in that column</p>
<p>y axis (right green bars) show the number of missing values in the columns in orange blocks</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the intersect of the 5 columns with the most missing values</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This means that some combinations of columns have missing values in the same row</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>na.demographics <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(covered,employment,year) <span class="sc">|&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_na_intersect</span>(<span class="at">only_na =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="determining-if-na-observations-are-the-same" class="level3">
<h3 class="anchored" data-anchor-id="determining-if-na-observations-are-the-same"><strong>Determining if NA Observations are the Same:</strong></h3>
<p>Missing values can be the same observation across several columns. The visdat package can solve this with the <code>vis_miss()</code> function which shows the rows with missing values through <code>ggplotly()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactive plotly() plot of all NA values to examine every row</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#na.demographics |&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a> <span class="co">#select(covered, employment, year) |&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a> <span class="co">#vis_miss() |&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a> <span class="co">#ggplotly() </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="classifying-outliers" class="level3">
<h3 class="anchored" data-anchor-id="classifying-outliers"><strong>Classifying Outliers:</strong></h3>
<p>Before imputing outliers, you will want to diagnose whether it’s they are natural outliers or not.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>demographics <span class="sc">%&gt;%</span> <span class="co"># Set the simulated normal data as a data frame</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span>year, <span class="at">y =</span> facet, <span class="at">fill =</span>facet)) <span class="sc">+</span> <span class="co"># Create a ggplot</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>, <span class="at">outlier.alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span>  <span class="co"># Relabel the x axis label</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Covered"</span>) <span class="sc">+</span> <span class="co"># Remove the y axis label</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove the legend </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mean-imputation" class="level3">
<h3 class="anchored" data-anchor-id="mean-imputation">Mean Imputation:</h3>
<p>The mean of the observed values for each variable is computed and the outliers for that variable are imputed by this mean</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mean_out_imp_p_covered <span class="ot">&lt;-</span> demographics <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_covered) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(p_covered, <span class="at">method =</span> <span class="st">"mean"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>mean_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with mean

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "1235"   "1235"    
na                  "92"     "92"      
mean                "0.23"   "0.21"    
sd                  "0.16"   "0.12"    
se_mean             "0.0046" "0.0033"  
IQR                 "0.19"   "0.13"    
skewness            "1.5"    "1.0"     
kurtosis            "2.17"   "0.64"    
p00                 "0.027"  "0.027"   
p01                 "0.032"  "0.032"   
p05                 "0.058"  "0.058"   
p10                 "0.087"  "0.087"   
p20                 "0.12"   "0.12"    
p25                 "0.12"   "0.12"    
p30                 "0.13"   "0.13"    
p40                 "0.15"   "0.15"    
p50                 "0.17"   "0.17"    
p60                 "0.21"   "0.21"    
p70                 "0.25"   "0.23"    
p75                 "0.31"   "0.25"    
p80                 "0.35"   "0.31"    
p90                 "0.44"   "0.38"    
p95                 "0.60"   "0.44"    
p99                 "0.79"   "0.57"    
p100                "0.84"   "0.60"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of the mean imputation</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mean_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="median-imputation" class="level3">
<h3 class="anchored" data-anchor-id="median-imputation">Median Imputation:</h3>
<p>The median of the observed values for each variable is computed and the outliers for that variable are imputed by this median</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>med_out_imp_p_covered <span class="ot">&lt;-</span> demographics <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_covered) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(p_covered, <span class="at">method =</span> <span class="st">"median"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>med_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with median

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "1235"   "1235"    
na                  "92"     "92"      
mean                "0.23"   "0.20"    
sd                  "0.16"   "0.12"    
se_mean             "0.0046" "0.0034"  
IQR                 "0.19"   "0.13"    
skewness            "1.5"    "1.1"     
kurtosis            "2.17"   "0.73"    
p00                 "0.027"  "0.027"   
p01                 "0.032"  "0.032"   
p05                 "0.058"  "0.058"   
p10                 "0.087"  "0.087"   
p20                 "0.12"   "0.12"    
p25                 "0.12"   "0.12"    
p30                 "0.13"   "0.13"    
p40                 "0.15"   "0.15"    
p50                 "0.17"   "0.17"    
p60                 "0.21"   "0.19"    
p70                 "0.25"   "0.23"    
p75                 "0.31"   "0.25"    
p80                 "0.35"   "0.31"    
p90                 "0.44"   "0.38"    
p95                 "0.60"   "0.44"    
p99                 "0.79"   "0.57"    
p100                "0.84"   "0.60"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of the median imputation</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>med_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mode-imputation" class="level3">
<h3 class="anchored" data-anchor-id="mode-imputation">Mode Imputation:</h3>
<p>The mode of the observed values for each variable is computed and the outliers for that variable are imputed by this mode</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mode_out_imp_p_covered <span class="ot">&lt;-</span> demographics <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_covered) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(p_covered, <span class="at">method =</span> <span class="st">"mode"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>mode_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with mode

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "1235"   "1235"    
na                  "92"     "92"      
mean                "0.23"   "0.20"    
sd                  "0.16"   "0.12"    
se_mean             "0.0046" "0.0035"  
IQR                 "0.19"   "0.14"    
skewness            "1.53"   "0.98"    
kurtosis            "2.17"   "0.47"    
p00                 "0.027"  "0.027"   
p01                 "0.032"  "0.027"   
p05                 "0.058"  "0.027"   
p10                 "0.087"  "0.058"   
p20                 "0.12"   "0.11"    
p25                 "0.12"   "0.12"    
p30                 "0.13"   "0.12"    
p40                 "0.15"   "0.14"    
p50                 "0.17"   "0.16"    
p60                 "0.21"   "0.19"    
p70                 "0.25"   "0.23"    
p75                 "0.31"   "0.25"    
p80                 "0.35"   "0.31"    
p90                 "0.44"   "0.38"    
p95                 "0.60"   "0.44"    
p99                 "0.79"   "0.57"    
p100                "0.84"   "0.60"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of the mode imputation</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mode_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="capping-imputation-aka-winsorizing" class="level3">
<h3 class="anchored" data-anchor-id="capping-imputation-aka-winsorizing"><strong>Capping Imputation (aka Winsorizing):</strong></h3>
<p>The Percentile Capping is a method of Imputing the outlier values by replacing those observations outside the lower limit with the value of 5th percentile and those that lie above the upper limit, with the value of 95th percentile of the same dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cap_out_imp_p_covered <span class="ot">&lt;-</span> demographics <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_covered) <span class="sc">|&gt;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_outlier</span>(p_covered, <span class="at">method =</span> <span class="st">"capping"</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Output showing the summary statistics of our imputation</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>cap_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impute outliers with capping

* Information of Imputation (before vs after)
                    Original Imputation
described_variables "value"  "value"   
n                   "1235"   "1235"    
na                  "92"     "92"      
mean                "0.23"   "0.23"    
sd                  "0.16"   "0.15"    
se_mean             "0.0046" "0.0041"  
IQR                 "0.19"   "0.19"    
skewness            "1.5"    "1.1"     
kurtosis            "2.17"   "0.53"    
p00                 "0.027"  "0.027"   
p01                 "0.032"  "0.032"   
p05                 "0.058"  "0.058"   
p10                 "0.087"  "0.087"   
p20                 "0.12"   "0.12"    
p25                 "0.12"   "0.12"    
p30                 "0.13"   "0.13"    
p40                 "0.15"   "0.15"    
p50                 "0.17"   "0.17"    
p60                 "0.21"   "0.21"    
p70                 "0.25"   "0.25"    
p75                 "0.31"   "0.31"    
p80                 "0.35"   "0.35"    
p90                 "0.44"   "0.44"    
p95                 "0.6"    "0.6"     
p99                 "0.79"   "0.60"    
p100                "0.84"   "0.60"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of the capping imputation</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>cap_out_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="imputing-nas" class="level2">
<h2 class="anchored" data-anchor-id="imputing-nas"><strong>Imputing NAs:</strong></h2>
<p>We can use the impute_na() method.</p>
<section id="k-nearest-neighbor-knn-imputation" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbor-knn-imputation"><strong>K-Nearest Neighbor (KNN) Imputation:</strong></h3>
<p>KNN is a machine learning algorithm that classifies data by similarity. This in effect clusters data into similar groups. The algorithm predicts values of new data to replace NA values based on how closely they resembles training data points, such as by comparing across other columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># KNN plot of our dataset without categories</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data_omit <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(demographics)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>demographicsAlt <span class="ot">&lt;-</span> demographics</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>demographicsAlt <span class="ot">&lt;-</span> <span class="fu">top_n</span>(demographics,<span class="dv">20</span>,facet)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">clara</span>(data_omit[<span class="sc">-</span><span class="dv">5</span>], <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#demographics.noNA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#demographicsnona &lt;- demographics.noNA </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#knn_na_imp_pa_covered &lt;- demographicsnona|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># imputate_na(covered, method = "knn")</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot showing the results of our imputation</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#knn_na_imp_pa_covered |&gt;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="there-are-no-missing-values-in-the-dataset." class="level4">
<h4 class="anchored" data-anchor-id="there-are-no-missing-values-in-the-dataset.">There are no missing values in the dataset.</h4>
</section>
</section>
<section id="recursive-partitioning-and-regression-trees-rpart" class="level3">
<h3 class="anchored" data-anchor-id="recursive-partitioning-and-regression-trees-rpart"><strong>Recursive Partitioning and Regression Trees (rpart):</strong></h3>
<p>rpart is a decision tree machine learning algorithm that builds classification or regression models through a two stage process, which can be thought of as binary trees. The algorithm splits the data into subsets, which move down other branches of the tree until a termination criteria is reached.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    set_names</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dlookr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>non_numeric <span class="ot">&lt;-</span> demographics <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>rpart_na_imp_p_covered <span class="ot">&lt;-</span> non_numeric <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_na</span>(p_covered, <span class="at">method =</span> <span class="st">"rpart"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot showing the results of our imputation</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>rpart_na_imp_p_covered <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="multivariate-imputation-by-chained-equations-mice" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-imputation-by-chained-equations-mice"><strong>Multivariate Imputation by Chained Equations (MICE):</strong></h3>
<p>MICE is an algorithm that fills missing values multiple times, hence dealing with uncertainty better than other methods. This approach creates multiple copies of the data that can then be analyzed and then pooled into a single dataset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw summary, output suppressed</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mice_na_imp_p_covered <span class="ot">&lt;-</span> na.demographics <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">imputate_na</span>(p_covered, <span class="at">method =</span> <span class="st">"mice"</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  year  sample_size  employment  members  p_members  p_covered
  1   2  year  sample_size  employment  members  p_members  p_covered
  1   3  year  sample_size  employment  members  p_members  p_covered
  1   4  year  sample_size  employment  members  p_members  p_covered
  1   5  year  sample_size  employment  members  p_members  p_covered
  2   1  year  sample_size  employment  members  p_members  p_covered
  2   2  year  sample_size  employment  members  p_members  p_covered
  2   3  year  sample_size  employment  members  p_members  p_covered
  2   4  year  sample_size  employment  members  p_members  p_covered
  2   5  year  sample_size  employment  members  p_members  p_covered
  3   1  year  sample_size  employment  members  p_members  p_covered
  3   2  year  sample_size  employment  members  p_members  p_covered
  3   3  year  sample_size  employment  members  p_members  p_covered
  3   4  year  sample_size  employment  members  p_members  p_covered
  3   5  year  sample_size  employment  members  p_members  p_covered
  4   1  year  sample_size  employment  members  p_members  p_covered
  4   2  year  sample_size  employment  members  p_members  p_covered
  4   3  year  sample_size  employment  members  p_members  p_covered
  4   4  year  sample_size  employment  members  p_members  p_covered
  4   5  year  sample_size  employment  members  p_members  p_covered
  5   1  year  sample_size  employment  members  p_members  p_covered
  5   2  year  sample_size  employment  members  p_members  p_covered
  5   3  year  sample_size  employment  members  p_members  p_covered
  5   4  year  sample_size  employment  members  p_members  p_covered
  5   5  year  sample_size  employment  members  p_members  p_covered</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot showing the results of our imputation</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>mice_na_imp_p_covered <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw-02-02_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>